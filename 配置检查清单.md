# 项目配置检查清单

## ✅ 已自动修复的问题

1. ✅ **后台视图模块导入问题**
   - 文件：`server/myapp/views/admin/__init__.py`
   - 问题：导入路径错误
   - 修复：改为相对导入 `from . import xxx`

2. ✅ **前端API地址配置**
   - 文件：`web/src/store/constants.ts`
   - 问题：指向远程服务器
   - 修复：改为本地地址 `http://127.0.0.1:8000/myapp`

3. ✅ **PyMySQL初始化**
   - 文件：`server/server/__init__.py`
   - 状态：已正确配置

## ⚠️ 需要手动配置的项

### 1. 数据库配置（必须）

**文件**：`server/server/settings.py`

**需要修改的内容**：
```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'python_food',  # 数据库名（无需修改）
        'USER': 'root',  # ⚠️ 修改为你的MySQL用户名
        'PASSWORD': '4643830',  # ⚠️ 修改为你的MySQL密码
        'HOST': '127.0.0.1',  # 数据库主机（本地无需修改）
        'PORT': '3306',  # 数据库端口（默认无需修改）
        'OPTIONS': {
            "init_command": "SET foreign_key_checks = 0;",
        }
    }
}
```

### 2. 数据库创建和导入（必须）

**步骤1：创建数据库**
```sql
CREATE DATABASE IF NOT EXISTS python_food DEFAULT CHARSET utf8 COLLATE utf8_general_ci;
```

**步骤2：导入SQL文件**

方式一（MySQL命令行）：
```sql
USE python_food;
SOURCE D:/github/LocalResposity/Campus/python_food/python_food.sql;
```

方式二（命令行）：
```bash
mysql -u root -p python_food < python_food.sql
```

**注意**：请将路径 `D:/github/LocalResposity/Campus/python_food/python_food.sql` 替换为实际的SQL文件路径。

## 📋 运行前检查清单

### 后端检查

- [ ] Python 3.8 已安装
- [ ] MySQL 服务已启动
- [ ] 数据库 `python_food` 已创建
- [ ] SQL文件已导入
- [ ] `server/server/settings.py` 数据库配置已修改
- [ ] Python依赖已安装（`pip install -r requirements.txt`）
- [ ] `server/upload` 目录存在（已存在，无需创建）

### 前端检查

- [ ] Node.js 16.14+ 已安装
- [ ] `web/src/store/constants.ts` API地址已配置（已自动配置）
- [ ] 前端依赖已安装（`npm install`）

## 🚀 启动命令

### 后端启动

```bash
cd server
python manage.py runserver 0.0.0.0:8000
```

### 前端启动

```bash
cd web
npm run dev
```

## 🔍 验证运行

### 后端验证

1. 访问：http://127.0.0.1:8000/admin/
   - 应该显示Django管理后台登录页面

2. 测试API：http://127.0.0.1:8000/myapp/index/classification/list
   - 应该返回分类列表的JSON数据

### 前端验证

1. 访问：http://localhost:5173
   - 应该显示前端页面

2. 检查浏览器控制台
   - 无错误信息
   - API请求正常

## ⚠️ 常见问题

### 问题1：数据库连接失败

**错误**：`django.db.utils.OperationalError: (2003, "Can't connect to MySQL server")`

**解决**：
1. 检查MySQL服务是否启动
2. 检查数据库配置是否正确
3. 确认数据库 `python_food` 已创建

### 问题2：PyMySQL模块缺失

**错误**：`ModuleNotFoundError: No module named 'pymysql'`

**解决**：
```bash
pip install PyMySQL
```

### 问题3：数据库表不存在

**错误**：`django.db.utils.ProgrammingError: Table 'python_food.xxx' doesn't exist`

**解决**：
1. 确保已导入SQL文件
2. 或运行数据库迁移：
   ```bash
   python manage.py makemigrations
   python manage.py migrate
   ```

### 问题4：前端API请求失败

**错误**：跨域错误或404错误

**解决**：
1. 确保后端服务已启动
2. 检查 `web/src/store/constants.ts` 中的 `BASE_URL` 配置
3. 已自动配置为：`http://127.0.0.1:8000/myapp`

## 📝 注意事项

1. **数据库名称**：使用 `python_food`，不是 `shop`
2. **API路径**：前端API路径以 `/myapp/` 开头，BASE_URL也包含 `/myapp`，这是正常的（axios会正确处理）
3. **文件上传**：确保 `server/upload` 目录有写入权限
4. **端口冲突**：如果8000端口被占用，可以修改为其他端口（如9003）

## 📚 相关文档

- `快速运行指南.md` - 详细的运行步骤
- `运行指南.md` - 完整的运行指南
- `项目架构文档.md` - 项目架构说明
- `server/readme.md` - 后端部署说明

---

**完成以上配置后，项目即可正常运行！** 🎉


